# Next feature flags client [![Build Status](https://travis-ci.org/Financial-Times/next-feature-flags-client.svg?branch=no-client-poll)](https://travis-ci.org/Financial-Times/next-feature-flags-client)
[Feature toggles](http://martinfowler.com/bliki/FeatureToggle.html) for Next with abiility to override using `x-flags` header or `next-flags` cookie. Also sends reports to sentry of any expired flags still in use.

## Usage

### Client side
Should be constructed with an object matching the structure of the json returned by [next-feature-flags-api](https://github.com/Financial-Times/next-feature-flags-api). By including `{{>next-feature-flags-client/templates/flags}}` in your [next-express](https://github.com/Financial-Times/next-express) app's template this is taken care of for you.

Client side flags do not poll for updates

### Server side
Does not need to be constructed with an object of values, but should be initialised with a url to request flags. This is taken care of by [next-express](https://github.com/Financial-Times/next-express), as is middleware for making flags available to requests.

## API

### `init(options)`
Initialises the flag client. Options may have 3 self-explanatory properties:
- `url` - the url from which to fetch flag updates
- `timeout` - length of time to wait for response from the flag server [default 3000]
- `interval` - interval between attempts to fetch fresh flag data [default 30000]

Returns a promise that is resolved when flags have been successfully fetched at least once (or that resolves immediately if none of the above options are passed)

### `getArray()`
Returns a simplified array of flags similar to that retrieved from the flags api, but lacking expiry date information.

### `get(name)`
Returns the current state of a flag (or false if the flag doesn't exist). If no name is provided it returns a hash of all current flag objects, including information on expiry dates
