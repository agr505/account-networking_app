'use strict';
var request = require('request');
var debug = require('debug')('ft-next-splunk-logger');
var https = require('https');
var httpsAgent = new https.Agent({ keepAlive: true});

function onMessage(message){
	request({
		method : 'POST',
		url : process.env.SPLUNK_URL,
		followRedirect : true,
		strictSSL: false,
		pool : httpsAgent,
		body : message
	}, function(err, response){
		if(err){
			debug('Error: %s', err.message);
		}else{
			debug('Logged: %s', message);
		}
	});
}

process.on('message', onMessage);
